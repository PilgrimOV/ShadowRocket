# Shadowrocket: 2025-12-29 13:25:22
[General]

# Быстрая настройка Shadowrocket:
# Включите английский язык Настройки → Language → English
# Идем в Home и нажимаем «+» или Add Server
# Добавьте любой подходящий конфиг: Config → «+» или Download from URL
# В настройках выберите способ проверки Settings → Advanced → Connect
# Нажмите Connectivity Test и если сервер доступен, то нажмите на ползунок
# При первом запуске появится запрос на установку VPN-конфигурации — нажмите «OK» и «Разрешить».

# Включение HTTPS-декрипции:
# В Config → ⓘ, → HTTPS Decryption → Certificate → Generate A New CA Certificate → Install CA Certificate to System
# В настройках системы — скачанные профили — «Установить».
# В настройках системы — «Основные» — «О устройстве» — «Настройки доверия сертификатов» — включить сертификат Shadowrocket.
# Для синхронизации между устройствами, если конфиг содержит ключ, рекомендуется сразу установить сертификат, а не генерировать новый.

# Системные сетевые вызовы (например, push-уведомления, iOS системные сервисы) будут обходить прокси.
# Если выставить false, легитимный системный трафик может пойти через прокси,
# что приведёт к задержкам или некорректной работе системных функций.
bypass-system = true

# Отключение поддержки IPv6. В системах и сетях, где IPv6 стабильный и
# поддерживается, можно включить (true), иначе IPv4 останется основным
ipv6 = false

# Отдавать приоритет разрешению DNS-записей AAAA (IPv6) над A (IPv4).
# Важно только если ipv6 включён. Полезно на сетях с сильной поддержкой IPv6, иначе оставлять false.
prefer-ipv6 = false

# Если true, при DNS-запросах возвращаются приватные IP адреса (например, из диапазона 192.168.x.x). При false Shadowrocket будет считать домен "захваченным" и принудительно отправит трафик через прокси, что может нарушать локальную сеть. Обычно лучше оставлять true.
private-ip-answer = true

# DIRECT: системный DNS (чтобы RU не пересекал границу даже на уровне DNS)
dns-direct-system = true
dns-fallback-system = true
dns-direct-fallback-proxy = true

# PROXY/общий резолв: DoH (шифрованный DNS)
dns-server = https://dns.google/dns-query,https://cloudflare-dns.com/dns-query,https://dns.quad9.net/dns-query
fallback-dns-server = system

# Перехватывает DNS-запросы некоторых сервисов (Например, Netflix) на UDP/TCP порт 53 и направляет через программу
hijack-dns = :53

# Адреса/домены, обходящие прокси, но проходящие через туннель (TUN-интерфейс)
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,captive.apple.com

# IP-диапазоны, исключённые из туннеля (TUN-интерфейс). Например, UDP/DNS для стабильности сетевых сервисов
tun-excluded-routes = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32,239.255.255.250/32,198.18.0.0/15

# По умолчанию TUN пытается взять на себя весь трафик,
# но из-за системных особенностей часть трафика может обходить туннель.
# С помощью этого параметра можно добавить дополнительные IP-диапазоны или маршруты,
# которые гарантированно будут проходить через туннель Shadowrocket.
# Обычно оставляют пустым, если нет проблем с прохождением трафика.
# tun-included-routes =

# Позволяет SR возвращать настоящий IP вместо fake-IP для перечисленных доменов. Это важно для служб, где нужно "реальное" соединение без проксирования (например, NTP, Cloudflare client). Позволяет сократить проблемы с задержками, ошибками соединения и энергопотреблением.
always-real-ip = captive.apple.com,localhost,*.local,*.apple.com,*.icloud.com

# Включает автоматический ответ на ping (ICMP Echo Request) от имени TUN-интерфейса. Удобно для сетевой диагностики, но может приводить к созданию fake-IP маппинга, что увеличивает расход ресурсов и может в итоге разряжать аккумулятор. Если цель — минимизация fake-IP и энергозатрат, ставить false.
icmp-auto-reply = false

# Управляет, активна ли политика REJECT для URL-перезаписи вне режима конфигурации. При true REJECT работает постоянно, что может «жёстко» блокировать трафик.
always-reject-url-rewrite = false

# Как поступать с UDP-трафиком, если политика узла не поддерживает UDP-перенаправление: отбрасывать (REJECT) или направлять напрямую (DIRECT). Выбор зависит от желаемого поведения и возможности узла.
udp-policy-not-supported-behaviour = REJECT

# URL-адрес обновления файла конфигурации
update-url = https://raw.githubusercontent.com/PilgrimOV/ShadowRocket/main/Basic.conf

# Выбираем наиболее быстрый сервера для прокси
# [Proxy Group]
# AUTO = url-test,interval=600,timeout=5,url=https://cp.cloudflare.com/generate_204,policy-regex-filter=*

# Добавьте эти адреса в настройках программы Settings → GeoLite2 Database
# country: https://github.com/P3TERX/GeoLite.mmdb/raw/download/GeoLite2-Country.mmdb
# asn: https://github.com/P3TERX/GeoLite.mmdb/raw/download/GeoLite2-ASN.mmdb

# Выборочные правила маршрутизации

[Rule]
# Локальная сеть
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Lan/Lan.list,DIRECT

# Россия — всегда DIRECT
GEOIP,RU,DIRECT
DOMAIN-SUFFIX,ru,DIRECT
DOMAIN-SUFFIX,рф,DIRECT
DOMAIN-SUFFIX,xn--p1ai,DIRECT

# Шахматы
#DOMAIN-SUFFIX,chess.com,PROXY,force-remote-dns
DOMAIN-SUFFIX,chesscomfiles.com,PROXY,force-remote-dns
#DOMAIN-SUFFIX,lichess.org,PROXY,force-remote-dns
#DOMAIN-SUFFIX,lichess1.org,PROXY,force-remote-dns

# Наш список доменов
RULE-SET,https://raw.githubusercontent.com/PilgrimOV/ShadowRocket/main/Custom_proxy.list,PROXY,force-remote-dns

# OpenAI
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/OpenAI/OpenAI.list,PROXY,force-remote-dns

# Google / Gemini / YouTube / YouTubeMusic
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Google/Google.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Gemini/Gemini.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/YouTube/YouTube.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/YouTubeMusic/YouTubeMusic.list,PROXY,force-remote-dns

# Telegram / Discord / WhatsApp
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Telegram/Telegram.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Discord/Discord.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/WhatsApp/WhatsApp.list,PROXY,force-remote-dns

# GitHub / Microsoft / Copilot / Bing
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/GitHub/GitHub.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Microsoft/Microsoft.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Copilot/Copilot.list,PROXY,force-remote-dns
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Shadowrocket/Bing/Bing.list,PROXY,force-remote-dns

# 8) По умолчанию — DIRECT
FINAL,DIRECT