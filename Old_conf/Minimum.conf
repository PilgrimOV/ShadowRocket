# Shadowrocket: Minimum.conf
[General]

# Системные сетевые вызовы (например, push-уведомления, iOS системные сервисы) будут обходить прокси.
bypass-system = true

# Отключение поддержки IPv6.
ipv6 = false
prefer-ipv6 = false

# Если true, при DNS-запросах возвращаются приватные IP адреса (например, из диапазона 192.168.x.x). Обычно лучше оставлять true.
private-ip-answer = true

# По умолчанию системный DNS отключен, но при проблемах откат на системный
dns-direct-system = false
dns-direct-fallback-proxy = true
dns-fallback-system = true
fallback-dns-server = system
hijack-dns = :53
dns-server = system,https://dns.adguard-dns.com/dns-query,cloudflare-dns.com,dns.quad9.net,dns.adguard-dns.com,dns.comss.one

# Адреса/домены, обходящие прокси, но проходящие через туннель (TUN-интерфейс)
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,127.0.0.0/8,169.254.0.0/16,100.64.0.0/10,198.18.0.0/15,localhost,*.local,captive.apple.com

# IP-диапазоны, исключённые из туннеля (TUN-интерфейс). Например, UDP/DNS для стабильности сетевых сервисов
tun-excluded-routes = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32,239.255.255.250/32,198.18.0.0/15

# С помощью этого параметра можно добавить дополнительные IP-диапазоны или маршруты, которые гарантированно будут проходить через туннель Shadowrocket. Обычно оставляют пустым, если нет проблем с прохождением трафика.
# tun-included-routes =

# Позволяет SR возвращать настоящий IP вместо fake-IP для перечисленных доменов. Это важно для служб, где нужно "реальное" соединение без проксирования.
always-real-ip = captive.apple.com,localhost,*.local,*.apple.com,*.icloud.com

# Включает автоматический ответ на ping (ICMP Echo Request) от имени TUN-интерфейса.
icmp-auto-reply = false

# Управляет, активна ли политика REJECT для URL-перезаписи вне режима конфигурации. При true REJECT работает постоянно, что может «жёстко» блокировать трафик.
always-reject-url-rewrite = false

# Как поступать с UDP-трафиком, если политика узла не поддерживает UDP-перенаправление: отбрасывать (REJECT) или направлять напрямую (DIRECT). Выбор зависит от желаемого поведения и возможности узла.
udp-policy-not-supported-behaviour = REJECT

# Добавьте эти адреса в настройках программы Settings → GeoLite2 Database
# country: https://github.com/P3TERX/GeoLite.mmdb/releases/latest/download/GeoLite2-Country.mmdb
# asn: https://github.com/P3TERX/GeoLite.mmdb/releases/latest/download/GeoLite2-ASN.mmdb

# URL-адрес обновления файла конфигурации
update-url = https://raw.githubusercontent.com/PilgrimOV/ShadowRocket/main/Minimum.conf

[Rule]
AND,((PROTOCOL,UDP),(DEST-PORT,443)),REJECT

# Локальная сеть
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Lan/Lan.list,DIRECT

# APPLE
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Apple/Apple.list,DIRECT

# Наш список доменов
RULE-SET,https://raw.githubusercontent.com/PilgrimOV/ShadowRocket/main/Custom_proxy.list,PROXY,force-remote-dns

# OpenAI
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/OpenAI/OpenAI.list,PROXY,force-remote-dns

# Google / Gemini / YouTube / YouTubeMusic
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Google/Google.list,PROXY,force-remote-dns
RULE-SET,RULE-SET,https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geosite/google-gemini.list,PROXY,force-remote-dns
RULE-SET,https://raw.githubusercontent.com/PilgrimOV/ShadowRocket/main/Gemini_ip.list,PROXY,no-resolve
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/YouTube/YouTube.list,PROXY,force-remote-dns
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/YouTubeMusic/YouTubeMusic.list,PROXY,force-remote-dns

# WhatsApp
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Whatsapp/Whatsapp.list,PROXY,force-remote-dns
RULE-SET,https://raw.githubusercontent.com/HybridNetworks/whatsapp-cidr/refs/heads/main/WhatsApp/whatsapp_cidr_ipv4.list,PROXY,no-resolve

# GitHub / Copilot
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/GitHub/GitHub.list,PROXY,force-remote-dns
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Shadowrocket/Copilot/Copilot.list,PROXY,force-remote-dns

FINAL,DIRECT